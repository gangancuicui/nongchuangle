(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpkg/editor/editor"],{"0683":function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("fc87");o(n("66fd"));var c=o(n("9bab"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(c.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},1809:function(e,t,n){"use strict";var o=n("52e4"),c=n.n(o);c.a},"21aa":function(e,t,n){"use strict";(function(e,o){var c=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=c(n("2eee")),i=c(n("c973")),r=(n("26cb"),function(){n.e("components/richText/richText").then(function(){return resolve(n("e97e"))}.bind(null,n)).catch(n.oe)}),l=getApp(),u={components:{richText:r},data:function(){return{readOnly:!1,title:"",coverimg:"",userinfo:JSON.parse(e.getStorageSync("userinfo")||"{}"),placeholder:"开始编辑吧...",textTool:"",array:["选种","种植","销售"],index:0}},onLoad:function(e){console.log(this.userinfo),console.log(this.getCurrDateStr()),console.log(this.array[this.index])},onShow:function(){},methods:{getCurrDateStr:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1;n=n<10?"0"+n:n;var o=e.getDate();return o=o<10?"0"+o:o,t+"-"+n+"-"+o},addData:function(){var t=this;return(0,i.default)(a.default.mark((function n(){var c;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o.showLoading({title:"插入中",mask:!0}),n.next=3,e.cloud.database().collection("farmer").add({data:{author:t.userinfo.nickName,cTime:t.getCurrDateStr(),content:l.globalData.data.richTextContents,img:t.coverimg,paperid:t.array[t.index],title:t.title}}).then((function(e){return e})).catch((function(e){return e}));case 3:if(c=n.sent,o.hideLoading(),console.log(c._id),c._id){n.next=9;break}return o.showToast({title:"插入失败",icon:"error"}),n.abrupt("return");case 9:o.showToast({title:"插入成功",icon:"success"}),o.navigateBack({delta:1});case 11:case"end":return n.stop()}}),n)})))()},onKeyInput:function(e){this.title=e.detail.value},bindPickerChange:function(e){this.index=e.detail.value},uploadPaper:function(e){this.addData()},upimg:function(t){var n=this;console.log(this.userinfo),e.chooseMedia({count:1,mediaType:["image"],sourceType:["album","camera"],camera:"back",success:function(e){console.log(e.tempFiles[0].tempFilePath),n.upImgToDB(e.tempFiles[0].tempFilePath)}})},upImgToDB:function(t){var n=this;o.cloud.uploadFile({cloudPath:"文章内容/"+Date.now()+"/"+this.userinfo.nickName+"-"+this.title+".jpg",filePath:t}).then((function(e){n.coverimg=e.fileID})).catch((function(t){e.showToast({title:"失败",icon:"error",duration:2e3})}))},onEditorReady:function(e,t){console.log("[onEditorReady callback]"),r=this.createSelectorQuery("#richText")},setContents:function(e){this.editorCtx.setContents({html:e,success:function(e){console.log("[setContents success]",e)}})},undo:function(e,t){console.log("[undo callback]")},restore:function(e,t){console.log("[restore callback]")},clear:function(){this.editorCtx.clear({success:function(e){console.log("[clear success]",e)}})},clearBeforeEvent:function(t,n){var o=this;console.log("[clearBeforeEvent callback]"),e.showModal({cancelText:"取消",confirmText:"确认",content:"确认清空编辑器内容吗？",success:function(e){e.confirm&&o.$refs.richText.clear()},fail:function(e){}})},clearSuccess:function(e,t){console.log("[clearSuccess callback]")},removeFormat:function(){this.editorCtx.removeFormat()},insertImageEvent:function(t,n){var c=this;console.log(1),e.chooseImage({count:1,success:function(t){console.log(t);var n=t.tempFilePaths[0];o.cloud.uploadFile({cloudPath:"文章头图/"+Date.now()+"/"+c.userinfo.nickName+".jpg",filePath:n}).then((function(e){console.log(e.fileID),c.$refs.richText.insertImageMethod(e.fileID).then((function(e){console.log("[insert image success callback]=>",e)})).catch((function(e){console.log("[insert image fail callback]=>",e)}))})).catch((function(t){e.showToast({title:"失败",icon:"error",duration:2e3})}))}})},getEditorContent:function(t,n){var o=t.detail.value;console.log(t.detail.__args__[0].detail.value.html),e.showToast({title:"获取编辑器内容成功",icon:"none"}),console.log("[getEditorContent callback]=>",o)},showTextTool:function(){this.setData({textTool:!this.textTool})},bindfocus:function(e,t){e.detail.value},bindblur:function(e,t){e.detail.value},bindinput:function(e){e.detail.value;console.log(1),console.log(l.globalData),l.globalData.data.richTextContents=e.detail.__args__[0].detail.value.detail.html},preview:function(){e.navigateTo({url:"../preview/preview"})}}};t.default=u}).call(this,n("543d")["default"],n("bc2e")["default"])},"52e4":function(e,t,n){},6394:function(e,t,n){"use strict";n.r(t);var o=n("21aa"),c=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=c.a},"9bab":function(e,t,n){"use strict";n.r(t);var o=n("e991"),c=n("6394");for(var a in c)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return c[e]}))}(a);n("1809");var i=n("f0c5"),r=Object(i["a"])(c["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=r.exports},e991:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var o={richText:function(){return n.e("components/richText/richText").then(n.bind(null,"e97e"))}},c=function(){var e=this.$createElement;this._self._c},a=[]}},[["0683","common/runtime","common/vendor"]]]);